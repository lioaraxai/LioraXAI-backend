{% extends 'base_django.html' %}
{% load static %}

{% block title %}Contact | Nirdhar{% endblock %}

{% block content %}
    {% include 'includes/header.html' %}

    <main>
        <!-- Direct POST Test Link -->
        <div class="container py-2 mt-3">
            <div class="alert alert-warning">
                <h4>Form Submission Test</h4>
                <p>Click the button below to directly submit a test contact via POST:</p>
                <form method="post" action="/contact/">
                    {% csrf_token %}
                    <input type="hidden" name="name" value="Test User">
                    <input type="hidden" name="email" value="test@example.com">
                    <input type="hidden" name="company" value="Test Company">
                    <input type="hidden" name="message" value="This is a test submission to verify the contact form works.">
                    <button type="submit" class="btn btn-danger">Submit Test Contact Entry</button>
                </form>
            </div>
        </div>

        <!-- Hero Section -->
        <section class="py-5 py-md-6 bg-gradient-primary text-white">
            <div class="container py-4">
                <div class="row justify-content-center">
                    <div class="col-lg-8 text-center" data-aos="fade-up">
                        <h1 class="display-4 fw-bold mb-4">
                            Get in Touch
                        </h1>
                        <p class="lead mb-4 text-white">
                            Have questions about Nirdhar? Our team is here to help you.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Form Section -->
        <section class="py-5 py-md-6">
            <div class="container py-4">
                <div class="row g-5">
                    <!-- Contact Form -->
                    <div class="col-lg-7" data-aos="fade-up">
                        <div class="card shadow-sm rounded-4 border-0">
                            <div class="card-body p-4 p-lg-5">
                                <h2 class="mb-4 fw-bold">Send Us a Message</h2>
                                
                                <div class="col-md-12">
                                    <div class="p-4 shadow rounded bg-white">
                                        <h3 class="mb-4">Send Message</h3>
                                        
                                        {% if messages %}
                                            <div class="messages">
                                                {% for message in messages %}
                                                    <div class="alert alert-{{ message.tags }}">
                                                        {{ message }}
                                                    </div>
                                                {% endfor %}
                                            </div>
                                        {% endif %}
                                        
                                        <!-- Manual POST form submission to bypass all issues -->
                                        <form id="contact-form" method="post" action="">
                                            {% csrf_token %}
                                            <input type="hidden" name="submission_type" value="direct_form">
                                            
                                            <div class="mb-3">
                                                <label for="id_name" class="form-label">Full Name*</label>
                                                <input type="text" class="form-control" id="id_name" name="name" required>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="id_email" class="form-label">Email Address*</label>
                                                <input type="email" class="form-control" id="id_email" name="email" required>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="id_company" class="form-label">Company Name</label>
                                                <input type="text" class="form-control" id="id_company" name="company">
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="id_phone" class="form-label">Phone Number</label>
                                                <input type="text" class="form-control" id="id_phone" name="phone">
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="id_message" class="form-label">Your Message*</label>
                                                <textarea class="form-control" id="id_message" name="message" rows="5" required></textarea>
                                            </div>
                                            
                                            <button type="button" id="submit-button" class="btn btn-primary btn-lg">Submit Message</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Contact Information -->
                    <div class="col-lg-5" data-aos="fade-up" data-aos-delay="100">
                        <div class="ps-lg-4">
                            <h2 class="mb-4 fw-bold">Contact Information</h2>
                            
                            <div class="mb-4">
                                <h5 class="fw-bold">Email</h5>
                                <p class="mb-1">
                                    <a href="mailto:info@nirdhar.ai" class="text-decoration-none">info@nirdhar.ai</a>
                                </p>
                                <p class="text-secondary">
                                    We respond to most emails within 24 hours.
                                </p>
                            </div>
                            
                            <div class="mb-4">
                                <h5 class="fw-bold">Phone</h5>
                                <p class="mb-1">
                                    <a href="tel:+18005551234" class="text-decoration-none">+1 (800) 555-1234</a>
                                </p>
                                <p class="text-secondary">
                                    Available Monday - Friday, 9am - 5pm PST
                                </p>
                            </div>
                            
                            <div class="mb-4">
                                <h5 class="fw-bold">Headquarters</h5>
                                <address class="mb-0">
                                    Nirdhar AI<br>
                                    123 Technology Way<br>
                                    San Francisco, CA 94107
                                </address>
                            </div>
                            
                            <div class="mt-5">
                                <h5 class="fw-bold mb-3">Follow Us</h5>
                                <div class="d-flex gap-3">
                                    <a href="#" class="text-decoration-none fs-5">
                                        <i class="bi bi-twitter-x"></i>
                                    </a>
                                    <a href="#" class="text-decoration-none fs-5">
                                        <i class="bi bi-linkedin"></i>
                                    </a>
                                    <a href="#" class="text-decoration-none fs-5">
                                        <i class="bi bi-facebook"></i>
                                    </a>
                                    <a href="#" class="text-decoration-none fs-5">
                                        <i class="bi bi-instagram"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Map Section -->
        <section class="py-5 py-md-6 bg-light">
            <div class="container py-4">
                <div class="row justify-content-center mb-5">
                    <div class="col-lg-8 text-center">
                        <h2 class="display-6 fw-bold mb-4">Visit Our Office</h2>
                    </div>
                </div>
                <!-- Replace with actual map embed code -->
                <div class="ratio ratio-21x9" style="max-height: 500px;">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d25292.231851004046!2d-122.4194!3d37.7749!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80859a6d00690021%3A0x4a501367f076adff!2sSan%20Francisco%2C%20CA%2C%20USA!5e0!3m2!1sen!2sin!4v1626792742573!5m2!1sen!2sin" 
                            width="100%" height="100%" style="border:0; border-radius: 8px;" allowfullscreen="" loading="lazy"></iframe>
                </div>
            </div>
        </section>
    </main>

    {% include 'includes/footer.html' %}
    
    {% block extra_js %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get form and submit button elements
            const form = document.getElementById('contact-form');
            const submitButton = document.getElementById('submit-button');
            
            // Prevent submitting form when pressing Enter
            form.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    return false;
                }
            });
            
            // Handle form submission via the button only
            submitButton.addEventListener('click', function(event) {
                // Validate form
                if (form.checkValidity()) {
                    // Create a hidden form that will be submitted via POST
                    const hiddenForm = document.createElement('form');
                    hiddenForm.method = 'POST';
                    hiddenForm.action = '/contact/';
                    hiddenForm.style.display = 'none';
                    
                    // Add CSRF token
                    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                    const csrfInput = document.createElement('input');
                    csrfInput.type = 'hidden';
                    csrfInput.name = 'csrfmiddlewaretoken';
                    csrfInput.value = csrfToken;
                    hiddenForm.appendChild(csrfInput);
                    
                    // Add all form fields
                    const formData = new FormData(form);
                    for (const [key, value] of formData.entries()) {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = key;
                        input.value = value;
                        hiddenForm.appendChild(input);
                    }
                    
                    // Add form to the document and submit it
                    document.body.appendChild(hiddenForm);
                    console.log('Submitting form via POST...');
                    hiddenForm.submit();
                } else {
                    form.reportValidity();
                }
            });
        });
    </script>
    {% endblock %}
{% endblock %} 